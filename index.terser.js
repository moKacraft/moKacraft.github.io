var map=new Map;function retrieveURL(){var e=["https://displayapi.herokuapp.com/?"],t=retrieveParametersFormURL().t,a="",n="",r="";switch(e.push("website="),e.push(t),t){case void 0:case"4chan":break;case"reddit":var i=retrieveParametersFormURL().i,d=retrieveParametersFormURL().sort,o=retrieveParametersFormURL().after;e.push("&subreddit="),e.push(i),e.push("&sort="),e.push(d),void 0===o||(e.push("&after="),e.push(o)),t="Reddit",a="./display.html?website=reddit&subreddit=all&sort=hot",n="r/"+i,r="./display.html?website=reddit&subreddit="+i+"&sort="+d}var c=createDiv("webiste_title","display:flex;width:100vw;font-size:3vw;"),u=createH1("website","","");u.appendChild(createLink(a,t,""));var v=createH1("topic","","");return v.appendChild(createLink(r,n,"")),c.appendChild(u),c.appendChild(createBulletSpan()),c.appendChild(v),document.body.appendChild(c),e.join("")}function createH1(e,t,a){var n=document.createElement("h1");return n.id=e,n.textContent=t,n.style.cssText=a,n}function loadURL(e,t){var a=new XMLHttpRequest;a.open("GET",e,!0),a.setRequestHeader("Accept","application/json"),a.onloadend=onLoadEnd(a,t),a.send()}function onLoadEnd(e,t){return function(){var a=e.status,n=String(e.response);a>=200&&a<300&&t(n)}}function onDataLoaded(e){for(article in e=(e=JSON.parse(e)).message,console.log(e),e.children){var t=e.children[article];addArticle(t),map.set(t.name,JSON.stringify(t))}e.after;var a=e.o;addButton("loadMore","Load more","height:10vh;width:100vw;font-size:3em;",(function(){location.href=a}))}function addButton(e,t,a,n){var r=document.createElement("button");r.id=e,r.textContent=t,r.style.cssText=a,r.onclick=n,document.body.appendChild(r)}function addArticle(e){var t=createDiv(e.name,""),a=createDiv(e.name+"_title","display:flex;width:100vw;"),n=createLink(e.u,e.v,"font-size:2em;overflow:hidden;max-width:36vw;"),r=createLink(e.m,e.l,"font-size:2em;overflow:hidden;max-width:36vw;"),i=createLink(e.h,e.p,"font-size:2em;max-width:28vw;");a.appendChild(n),a.appendChild(createBulletSpan()),a.appendChild(r),a.appendChild(createBulletSpan()),a.appendChild(i),t.appendChild(a);var d=createDiv(e.name+"_content","display:flex;border-bottom: 1px solid black;width:100vw;"),o=document.createElement("img");o.style.cssText="width:25vw;height:10vh;",o.src=e.L,o.loading="lazy";var c=document.createElement("h2");c.style.cssText="width:75vw;",c.textContent=e.title,d.appendChild(o),d.appendChild(c),t.appendChild(d),document.body.appendChild(t),document.getElementById(d.id).onclick=function(){addElement(this)}}function addElement(e){var t=e.id+"big";if(document.body.contains(document.getElementById(t)))document.getElementById(t).remove();else{var a=map.get(e.id.replace("_content","")),n=JSON.parse(a);n.element.g?addImage(n.element.href,e):n.element.R?addVideo(n.element.href,e):n.element.k&&addEmbedElement(n.element.href,e)}}function addEmbedElement(e,t){var a=createDiv(t.id+"big","width:100vw;");a.appendChild(document.createRange().createContextualFragment(unescapeHtml(e))),a.firstChild.style.cssText="width:100vw;",t.parentNode.insertBefore(a,t.nextSibling)}function unescapeHtml(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'")}function addVideo(e,t){var a=document.createElement("video");a.style.cssText="width:100vw;",a.controls=!0,a.autoplay=!0,a.id=t.id+"big";var n=document.createElement("source");n.src=e,n.type="video/mp4",a.appendChild(n),t.parentNode.insertBefore(a,t.nextSibling)}function addImage(e,t){var a=document.createElement("img");a.style.cssText="width:100vw;",a.src=e,a.id=t.id+"big",t.parentNode.insertBefore(a,t.nextSibling)}function createLink(e,t,a){var n=document.createElement("a");return n.href=e,n.textContent=t,n.style.cssText=a,n}function createBulletSpan(){var e=document.createElement("span");return e.textContent="â€¢",e.style.cssText="font-size:2em;margin:1vw;",e}function createDiv(e,t){var a=document.createElement("div");return a.id=e,a.style.cssText=t,a}function retrieveParametersFormURL(){var e={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,a,n){e[a]=n})),e}loadURL(retrieveURL(),onDataLoaded);