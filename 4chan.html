<!DOCTYPE html>
<html>
<style>
    /* https://blog.koley.in/2019/339-bytes-of-responsive-css */
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
        line-height: 1.6;
        color: #222;
        max-width: 40rem;
        padding: 2rem;
        margin: auto;
        background: #fafafa;
    }

    img {
        max-width: 100%;
    }

    a {
        color: #2ECC40;
    }

    h1,
    h2,
    strong {
        color: #111;
    }
</style>

<body>
</body>
<script>
    //var url = "https://cors-hackity.herokuapp.com/" + "https://a.4cdn.org/g/catalog.json";
    var url = "http://localhost:4000/?website=4chan";
    loadURL(url, onDataLoaded);
    function loadURL(url, callBack) {
        var xhr = new XMLHttpRequest();
        xhr.open("GET", url, true);
        xhr.setRequestHeader("Accept", "application/json");
        xhr.onloadend = onLoadEnd(xhr, callBack);
        xhr.send();
    }

    function onLoadEnd(request, callBack) {
        return function () {
            var status = request.status;
            var result = String(request.response);
            if (status >= 200 && status < 300) callBack(result);
        };
    }

    function onDataLoaded(object) {
        object = JSON.parse(object);
        object = object.message;
        console.log(object);
        for (var i = 0; i < object.length; i++) {
            console.log(object[i]);
            for (var j = 0; j < object[i].threads.length; j++) {
                console.log(object[i].threads[j]);
                var link = document.createElement('a');
                link.href = "https://a.4cdn.org/g/thread/" + object[i].threads[j].no + ".json";
                link.textContent = "" + object[i].threads[j].no;
                document.body.appendChild(link);
                //link.style.cssText = cssText;

                var thumbnail = document.createElement('img');
                thumbnail.style.cssText = 'width:25vw;height:10vh;';
                //i.4cdn.org/g/1572537433319s.jpg
                var src = "https://i.4cdn.org/g/" + object[i].threads[j].tim + "s.jpg";
                console.log(src);
                thumbnail.src = src;
                document.body.appendChild(thumbnail);
                if (j % 2 === 0) {
                    document.body.appendChild(document.createElement('br'));
                }
            }
        }
    }
</script>

</html>