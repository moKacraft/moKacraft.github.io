var url,callBack,xhr,map=new Map;function createH1(id,textContent,cssText){var title=document.createElement("h1");return title.id=id,title.textContent=textContent,title.style.cssText=cssText,title}function addArticle(infos){var article=createDiv(infos.name,""),titleBar=createDiv(infos.name+"_title","display:flex;width:100vw;"),titleLink=createLink(infos.topicLinkHref,infos.topicLinkTextContent,"font-size:2em;overflow:hidden;max-width:36vw;"),websiteLink=createLink(infos.directLinkHref,infos.directLinkTextContent,"font-size:2em;overflow:hidden;max-width:36vw;"),commentsLink=createLink(infos.commentLinkHref,infos.commentLinkTextContent,"font-size:2em;max-width:28vw;");titleBar.appendChild(titleLink),titleBar.appendChild(createBulletSpan()),titleBar.appendChild(websiteLink),titleBar.appendChild(createBulletSpan()),titleBar.appendChild(commentsLink),article.appendChild(titleBar);var node=createDiv(infos.name+"_content","display:flex;border-bottom: 1px solid black;width:100vw;"),thumbnail=document.createElement("img");thumbnail.style.cssText="width:25vw;height:10vh;",thumbnail.src=infos.thumbnailSrc,thumbnail.loading="lazy";var title=document.createElement("h2");title.style.cssText="width:75vw;",title.textContent=infos.title,node.appendChild(thumbnail),node.appendChild(title),article.appendChild(node),document.body.appendChild(article),document.getElementById(node.id).onclick=function(){!function(parentNode){var bigId=parentNode.id+"big";if(document.body.contains(document.getElementById(bigId)))document.getElementById(bigId).remove();else{var value=map.get(parentNode.id.replace("_content","")),infos=JSON.parse(value);infos.element.isImage?function(url,parentNode){var image=document.createElement("img");image.style.cssText="width:100vw;",image.src=url,image.id=parentNode.id+"big",parentNode.parentNode.insertBefore(image,parentNode.nextSibling)}(infos.element.href,parentNode):infos.element.isVideo?function(source,parentNode){var video=document.createElement("video");video.style.cssText="width:100vw;",video.controls=!0,video.autoplay=!0,video.id=parentNode.id+"big";var src=document.createElement("source");src.src=source,src.type="video/mp4",video.appendChild(src),parentNode.parentNode.insertBefore(video,parentNode.nextSibling)}(infos.element.href,parentNode):infos.element.isEmbed&&function(content,parentNode){var embed=createDiv(parentNode.id+"big","width:100vw;");embed.appendChild(document.createRange().createContextualFragment(content.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'"))),embed.firstChild.style.cssText="width:100vw;",parentNode.parentNode.insertBefore(embed,parentNode.nextSibling)}(infos.element.href,parentNode)}}(this)}}function createLink(href,textContent,cssText){var link=document.createElement("a");return link.href=href,link.textContent=textContent,link.style.cssText=cssText,link}function createBulletSpan(){var bullet=document.createElement("span");return bullet.textContent="â€¢",bullet.style.cssText="font-size:2em;margin:1vw;",bullet}function createDiv(id,cssText){var div=document.createElement("div");return div.id=id,div.style.cssText=cssText,div}function retrieveParametersFormURL(){var vars={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(m,key,value){vars[key]=value})),vars}url=function(){var url=["https://displayapi.herokuapp.com/?"],website=retrieveParametersFormURL().website,websiteUrl="",topic="",topicUrl="";switch(url.push("website="),url.push(website),website){case void 0:case"4chan":break;case"reddit":var subreddit=retrieveParametersFormURL().subreddit,sort=retrieveParametersFormURL().sort,after=retrieveParametersFormURL().after;url.push("&subreddit="),url.push(subreddit),url.push("&sort="),url.push(sort),void 0===after||(url.push("&after="),url.push(after)),website="Reddit",websiteUrl="./display.html?website=reddit&subreddit=all&sort=hot",topic="r/"+subreddit,topicUrl="./display.html?website=reddit&subreddit="+subreddit+"&sort="+sort}var websiteDiv=createDiv("webiste_title","display:flex;width:100vw;font-size:3vw;"),websiteTitle=createH1("website","","");websiteTitle.appendChild(createLink(websiteUrl,website,""));var topicTitle=createH1("topic","","");return topicTitle.appendChild(createLink(topicUrl,topic,"")),websiteDiv.appendChild(websiteTitle),websiteDiv.appendChild(createBulletSpan()),websiteDiv.appendChild(topicTitle),document.body.appendChild(websiteDiv),url.join("")}(),callBack=function(object){for(article in(object=(object=JSON.parse(object)).message).children){var infos=object.children[article];addArticle(infos),map.set(infos.name,JSON.stringify(infos))}object.after;var callback,loadMore,url=object.loadMore;callback=function(){location.href=url},(loadMore=document.createElement("button")).id="loadMore",loadMore.textContent="Load more",loadMore.style.cssText="height:10vh;width:100vw;font-size:3em;",loadMore.onclick=callback,document.body.appendChild(loadMore)},(xhr=new XMLHttpRequest).open("GET",url,!0),xhr.setRequestHeader("Accept","application/json"),xhr.onloadend=function(request,callBack){return function(){var status=request.status,result=String(request.response);status>=200&&status<300&&callBack(result)}}(xhr,callBack),xhr.send();